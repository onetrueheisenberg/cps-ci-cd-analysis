FROM osrf/ros:foxy-desktop

RUN apt-get update && apt-get upgrade -y && \
    apt-get install --no-install-recommends -y \
    libasio-dev \
    python3-pip && \
    yes | pip3 install 'transformations==2018.9.5' && \
    apt-get clean && rm -rf /var/lib/apt/lists/*

WORKDIR /work/tello_ros_ws/src

RUN git clone https://github.com/clydemcqueen/tello_ros.git && \
    git clone https://github.com/ptrmu/ros2_shared.git && \
    git clone https://github.com/ptrmu/fiducial_vlam.git

WORKDIR /work/tello_ros_ws

RUN rosdep install -y --from-paths . --ignore-src

RUN /bin/bash -c "source /opt/ros/foxy/setup.bash && colcon build"